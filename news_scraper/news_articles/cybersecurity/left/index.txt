Washington (CNN) The Saudi military trainee who killed three US sailors and wounded several others in a terror attack last year on a military base in Pensacola, Florida , was a longtime associate of al Qaeda who had communicated with operatives from the group as recently as the night before the shooting, the Justice Department and the FBI announced Monday.

US investigators uncovered the al Qaeda connection after the FBI broke through the encryption protecting the Saudi attacker's iPhones and have been able to use the information on the devices to carry out a recent counterterrorism operation in Yemen, Attorney General William Barr and FBI Director Christopher Wray said at a news conference.

"The evidence we've been able to develop from the killer's devices shows that the Pensacola attack was actually the brutal culmination of years of planning and preparation by a longtime AQAP associate," Wray said, referring to al Qaeda in the Arabian Peninsula, one of the deadliest branches of the terror group.

Mohammed Alshamrani, a member of the Royal Saudi Air Force who had been training at Naval Air Station Pensacola, was killed by law enforcement during the attack.

The officials stopped short of saying that Alshamrani had been directed by the terror group, but said his ties to the AQAP began as far back as 2015 and were "significant."

The connection between the group and the attack marked a major development in the US fight against terrorism: Since 9/11, no foreign terrorist organization has successfully directed a deadly attack in the US, according to New America, a think tank.

Criticism of Apple

The officials also used the opportunity to hammer Apple for refusing to help investigators break into the devices.

Wray said that the FBI received "effectively no help" from Apple in bypassing the phones and that third-party technology firms were also unable to help investigators.

The fix that the FBI was able to develop for Alshamrani's phones "is not a fix for our broader Apple problem," Wray said, calling it a "pretty limited application."

Barr called it a "great disappointment" that Apple had refused to help investigators.

"Apple has made a business and marketing decision to design its phones in a way that only the user can unlock the contents no matter what the circumstances. In cases like this, where the user is a terrorist, or in other cases where the user is a violent criminal, a human trafficker, a child predator, Apple's decision has dangerous consequences for the public safety and the national security and is in my judgment unacceptable," Barr said.

Alshamrani was "meticulous" in his planning, Wray said, and had been coordinating "planning and tactics" with the operatives ahead of the attack. Alshamrani also wrote a "final will purporting to explain himself" that he had saved on his phone. The will was later released by AQAP when they claimed credit for the attack, Wray said.

"We now have a picture of him we didn't have before we obtained this evidence," Wray said.

Apple said in a statement Monday that the company doesn't believe in creating special access to its devices for the government because of security concerns.

"It is because we take our responsibility to national security so seriously that we do not believe in the creation of a backdoor â€” one which will make every device vulnerable to bad actors who threaten our national security and the data security of our customers," the company said.

"There is no such thing as a backdoor just for the good guys, and the American people do not have to choose between weakening encryption and effective investigations."

Al Qaeda link

The Justice Department has previously called the attack an act of terrorism that was motivated by "jihadist ideology." Alshamrani had made anti-American, anti-Israel and jihadi posts on social media -- including one on the September 11 anniversary -- that stated "the countdown has begun," and another two hours before the attack that referenced the words of an al Qaeda cleric.

During a 15-minute shooting spree, Alshamrani shot at a photo of President Donald Trump as well as a former president. He made statements during the attack that were critical of American servicemen overseas, the FBI has said.

AQAP had claimed responsibility for the Pensacola attack and said it was in touch with Alshamrani. In February, the White House announced that Qassim al-Rimi, the leader of the group, had been killed in an airstrike in Yemen

Barr would not say whether the second counterterrorism operation that targeted one of the AQAP associates that the shooter had talked with had killed the suspected terrorist in Yemen, though he said he was "very pleased" with the operation's results.

No other co-conspirators have been charged in the shooting, and Barr said earlier this year that investigators did not find evidence that any of the shooter's friends or fellow trainees from Saudi Arabia had advance knowledge that he was going to attack the base.

On Monday, Barr said the Saudi government continued to fully cooperate with the investigation and the Saudi Embassy in Washington said in a statement Monday evening they are providing "full support to our American counterparts."

"The Embassy of the Kingdom of Saudi Arabia reiterates its sincerest condolences to the American people on the tragedy that unfolded in December at Pensacola, Florida, and welcomes the announcement by US law authorities of the recovery of critical intelligence from the assailant's telephones," the statement said.

Investigators had initially been unable to retrieve data stored on two iPhones belonging to the shooter, and they cited that hurdle in trying to complete their investigation of the attacker's ideology and radicalization. Justice Department and FBI officials said Apple had helped provide access to iCloud and other data from the shooter's devices but that breaking the phones' encryption was key to retrieving more of Alshamrani's communications before the attack.

A number of lethal terror attacks in the US have been inspired by foreign terrorist organizations, although none have been successfully directed by the groups since the 9/11 attacks, which left nearly 3,000 people dead, according to a 2019 study by New America.

Al Qaeda thrived for years after 9/11, conducting deadly terror attacks in Europe and across the Middle East, but it was largely hollowed out under the Obama administration, which waged a campaign against the group's core in Pakistan. Trump announced last September that Hamza bin Laden, the son of the late al Qaeda leader Osama bin Laden, had been "killed in a United States counterterrorism operation in the Afghanistan/Pakistan region."

This story has been updated with additional details of the announcement and a statement from Apple.