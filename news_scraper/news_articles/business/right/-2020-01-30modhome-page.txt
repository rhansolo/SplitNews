Amazon.com Inc. defied its own disappointing forecast and returned to earnings growth in the holiday quarter with more than $3 billion in profit, sending shares soaring toward a $1 trillion valuation in the extended session Thursday.

The e-commerce and cloud-computing stalwart reported fourth-quarter profit of $3.3 billion, or $6.47 a share, on record quarterly sales of $87.4 billion, after reporting profit of $6.04 a share on sales of $72.38 billion a year ago. Analysts on average expected Amazon AMZN, +0.79% to report earnings of $4.04 a share on revenue of $86.03 billion, according to FactSet, after Amazon disappointed Wall Street with its holiday forecast three months ago.

Amazon healthily beat that holiday forecast, returning to growth after a decline in the previous quarter broke a streak of more than two years without a profit drop. After slowing down its spending in 2018, following the acquisition of Whole Foods Market Inc. and other efforts, the company enjoyed record annual profit of more than $10 billion.

In 2019, however, the company resumed spending to halve delivery times to Prime members and bolster its workforce, which harmed earnings in the third quarter. Thanks to the big earnings beat in the fourth quarter, though, Amazon surpassed 2018’s record profit total with $11.59 billion in net income for the year.

See also: There’s only one stock millennials prefer over Amazon and Tesla

Amazon Chief Executive Jeff Bezos disclosed in Thursday’s announcement that Prime members topped 150 million in the quarter, as delivery times were cut in half and free, two-hour grocery delivery was added to the benefits of the membership program. Bezos originally disclosed that Prime — which costs $119 a year or $12.99 a month — had surpassed 100 million members less than two years ago.

“Prime membership continues to get better for customers year after year. And customers are responding — more people joined Prime this quarter than ever before, and we now have over 150 million paid Prime members around the world,” Bezos said. “We’ve made Prime delivery faster — the number of items delivered to U.S. customers with Prime’s free one-day and same-day delivery more than quadrupled this quarter compared to last year.”

Amazon stock jumped about 11% in after-hours trading, after closing with a 0.7% increase to $1,870.68 that gave it a market capitalization of $927 billion. If those gains hold into Friday’s trading session, Amazon could top a $1 trillion market capitalization, joining Apple Inc. AAPL, -0.57% , Microsoft Corp. MSFT, -0.59% and Alphabet Inc. GOOGL, -0.66% GOOG, -0.29% in that exclusive club. Shares have lagged behind the S&P 500 index SPX, -0.56% amid Amazon’s spending increase, rising 11.9% in the past year as the S&P 500 has gained 22.1%.

In a conference call Thursday afternoon, Chief Financial Officer Brian Olsavsky said that Amazon spent less than the $1.5 billion he expected for the extra Prime benefits in the fourth quarter, benefiting Amazon’s profit total. As for the revenue surpassing Amazon’s guidance, Olsavsky credited the Prime additions as well as strong holiday traction.

“What we saw was essentially very strong holiday performance from the middle of November on. We also had a very big uptick in response to the one-day availability that’s been building through the year. I think Prime has been very strong,” he said.

The changes to Prime did increase costs for Amazon, which reported record worldwide spending costs for a quarter of $12.88 billion. Amazon had never previously cracked $10 billion in worldwide shipping costs in a single quarter.

Opinion: What Amazon is really accusing Trump of doing in JEDI deal

Amazon said that its Amazon Web Services cloud-computing segment was responsible for $2.6 billion in operating profit, 67% of Amazon’s total, on revenue of $9.95 billion. Analysts on average expected operating profit of $2.45 billion on sales of $9.87 billion, according to FactSet. North American e-commerce sales produced operating profit of $1.9 billion on sales of $53.67 billion, while international retail operations produced an operating loss of $617 million on revenue of $23.81 billion.

Amazon’s advertising business continued to grow at a healthy clip, with Amazon’s “Other” revenue — which Amazon says is mostly ad revenue with some other service offerings included — increasing 41.1% to a record $4.78 billion. Amazon’s physical stores, which is largely the Whole Foods business, continued to struggle for growth as in-person sales at brick-and-mortar Amazon locations declined 1% to $4.36 billion. It was the first time since the Whole Foods acquisition that Amazon reported more “Other” revenue than net sales from physical stores.

From 2018: Amazon is becoming an advertising giant

For the first quarter, Amazon forecast sales of $69 billion to $73 billion and operating income of $3 billion to $4 billion. Analysts on average were expecting operating profit of $4.04 billion on revenue of $71.63 billion, according to FactSet.