With support from Democratic Gov. Roy Cooper and the Republican-controlled legislature, North Carolina on Thursday passed what supporters brandished as a “repeal” of HB2, the state’s anti-LGBTQ law. But LGBTQ advocates are furious, arguing that the deal falls far short of the full repeal they were hoping for.

To understand why, let’s back up. HB2 had two major parts: It overturned and banned local statutes that protect LGBTQ people from discrimination based on sexual orientation or gender identity. And it prohibited transgender people from using bathrooms and locker rooms that align with their gender identity in schools and government buildings — due to a baseless myth that letting trans people use the bathroom or locker room for their gender identity would lead to men posing as trans to sexually harass and assault women in women’s facilities.

The deal does get rid of the latter: It makes it so state and local agencies in North Carolina can no longer regulate access to bathrooms or locker rooms, effectively ending the ban on trans people using the bathroom or locker room for their gender identity.

But the deal does not fully repeal the other part of HB2. It does seem to let nondiscrimination laws passed by local governments before HB2 kick back into effect. But it also continues to prohibit local governments from passing nondiscrimination laws until December 1, 2020, so cities like Charlotte over the next three years still won’t be able to pass a new law that bans discrimination against LGBTQ people. And the deal permanently prevents all government agencies in North Carolina, from local to state, from setting up trans-friendly bathroom or locker room policies, since they’ll no longer be allowed to regulate access to these facilities.

Since North Carolina has no statewide nondiscrimination laws protecting LGBTQ people, it will continue to be legal across much of the state for an employer to fire someone, a landlord to evict someone, and a business to kick someone out or engage in other kinds of discrimination solely because of the person’s sexual orientation or gender identity.

In fact, under the deal, private businesses will still be allowed to deny trans people the bathroom for their gender identity — and local governments will be powerless to stop them.

The deal is moving forward, but LGBTQ advocates are furious

Still, the deal moved forward. On Thursday, the state House and Senate passed the deal, and Cooper signed it into law. Cooper acknowledged that it’s “not a perfect deal,” but he argued that it “begins to repair our reputation.” (Former Gov. Pat McCrory, a Republican and Cooper’s predecessor, signed HB2 into law, and it’s widely credited for his electoral defeat last November.)

There’s economic pressure for the state to quickly repeal HB2. The Associated Press recently estimated that North Carolina will lose $3.76 billion over 12 years as a result of business boycotts against HB2. Part of that, however, could be alleviated if the state acts today: The NCAA, which opposes HB2, set a Thursday deadline for the state to either repeal the law or lose out on its chance to host college championship games. It’s unclear, though, if the deal meets the NCAA’s requirements.

The deal has also inspired swift protest from LGBTQ advocates. Chase Strangio, a trans advocate and attorney with the ACLU (which opposes HB2), called the deal “a fake repeal.” Mara Keisling, executive director of the National Center for Transgender Equality, argued, “This is not a repeal. Just a cynical package that will continue to hurt NC and trans people.” And Chad Griffin, president of the LGBTQ advocacy group HRC, said, “This isn't repeal. This doubles down on discrimination. This is a leadership test. And the Governor is failing.”

Just because Cooper got played doesn't mean the rest of the Dems in #ncga need to. Stand strong tomorrow and vote against #fakerepeal of HB2 — Chase Strangio (@chasestrangio) March 30, 2017

For more on HB2, read Vox’s explainer.